# Makefile.in - timsieved makefile
# $Id: Makefile.in,v 1.8 2000/01/28 22:09:56 leg Exp $
# @configure_input@
################################################################
#        Copyright 1998 by Carnegie Mellon University
#
#                      All Rights Reserved
#
#Permission to use, copy, modify, and distribute this software and its
#documentation for any purpose and without fee is hereby granted,
#provided that the above copyright notice appear in all copies and that
#both that copyright notice and this permission notice appear in
#supporting documentation, and that the name of Carnegie Mellon University
#not be used in advertising or publicity pertaining to distribution of the
#software without specific, written prior permission.
#
#CARNEGIE MELLON UNIVERSITY DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS
#SOFTWARE, INCLUDING #ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, 
#IN NO EVENT SHALL CARNEGIE MELLON UNIVERSITY BE LIABLE FOR ANY SPECIAL, 
#INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM 
#LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
#OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
#PERFORMANCE OF THIS SOFTWARE.
################################################################

srcdir = @srcdir@
VPATH = @srcdir@

CC = @CC@
RANLIB = @RANLIB@

INSTALL = @INSTALL@
CYRUS_USER=@cyrus_user@
CYRUS_GROUP=@cyrus_group@

DEFS = @DEFS@ @LOCALDEFS@
CPPFLAGS = -I. -I$(srcdir) -I$(srcdir)/../sieve -I$(srcdir)/../lib @COM_ERR_CPPFLAGS@ @CPPFLAGS@
CFLAGS = @CFLAGS@
LDFLAGS = @LDFLAGS@

prefix = @prefix@
exec_prefix = @exec_prefix@
cyrus_prefix = @cyrus_prefix@

MAKEDEPEND = @MAKEDEPEND@

TIMSIEVED_LIBS = @TIMSIEVED_LIBS@

IMAP_LIBS = @IMAP_LIBS@
IMAP_COM_ERR_LIBS = @IMAP_COM_ERR_LIBS@
LIBS = $(IMAP_COM_ERR_LIBS)
DEPLIBS=../sieve/libsieve.a ../lib/libcyrus.a @DEPLIBS@

PURIFY=/usr/local/bin/purify
PUREOPT=-best-effort

all: timsieved

install:
	$(INSTALL) @STRIP@ -o $(CYRUS_USER) -g $(CYRUS_GROUP) -m 755 timsieved $(DESTDIR)$(cyrus_prefix)/bin

OBJS= actions.o lex.o mystring.o config.o scripttest.o \
	timsieved.o parser.o

timsieved: $(OBJS)
	$(CC) $(LDFLAGS) -o timsieved $(OBJS) $(DEPLIBS) $(IMAP_LIBS) $(LIBS)

timsieved.pure: $(OBJS)
	$(PURIFY) $(PUREOPT) 	$(CC) $(LDFLAGS) -o timsieved.pure $(OBJS) $(DEPLIBS) $(IMAP_LIBS) $(LIBS)

clean:
	rm -f *.o *.a Makefile.bak makedepend.log

distclean: clean
	rm -f Makefile timsieved

depend:
	${MAKEDEPEND} $(CPPFLAGS) $(DEFS) -I$(srcdir) $(CFLAGS) *.c $(srcdir)/*.c 1>makedepend.log 2>&1

.c.o:
	$(CC) -c $(CPPFLAGS) $(DEFS) -I$(srcdir) -I. $(CFLAGS) \
	$<

#%-yacc.c %.tab.h: %.y
#	$(BISON) -y -d $< && mv y.tab.c $*-yacc.c && mv y.tab.h $*.tab.h

# DO NOT DELETE THIS LINE -- make depend depends on it.
